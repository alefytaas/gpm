<script>
  document.addEventListener("DOMContentLoaded", function() {
    const imageInput = document.getElementById('image_input');
    const imagePreview = document.getElementById('image_preview');

    imageInput.addEventListener('change', function() {
      const file = this.files[0];
      if (file) {
        const reader = new FileReader();
        
        reader.onload = function(e) {
          imagePreview.src = e.target.result;
          imagePreview.style.display = 'block';
        }
        
        reader.readAsDataURL(file);
      } else {
        imagePreview.src = '';
        imagePreview.style.display = 'none';
      }
    });
  });
</script>

<div class="container">
  <div class="row justify-content-center">
    <div class="col-md-8">
      <h2 class="text-center">Sign up</h2>

      <%= form_for(resource, as: resource_name, url: registration_path(resource_name), html: { class: "form" }) do |f| %>
        <%= render "devise/shared/error_messages", resource: resource %>

        <div class="form-group text-center">
          <%= image_tag '', id: 'image_preview', class: 'img-circle', style: 'max-width: 100px; display: none;' %>
        </div>
        <div class="form-group">
          <%= f.label :image %>
          <%= f.file_field :image, id: 'image_input', class: 'form-control' %>
        </div>



        <div class="form-group">
          <%= f.label :email %>
          <%= f.email_field :email, autofocus: true, autocomplete: "email", class: "form-control" %>
        </div>

        <div class="form-group">
          <%= f.label :password %>
          <% if @minimum_password_length %>
            <em>(<%= @minimum_password_length %> characters minimum)</em>
          <% end %>
          <%= f.password_field :password, autocomplete: "new-password", class: "form-control" %>
        </div>

        <div class="form-group">
          <%= f.label :password_confirmation %>
          <%= f.password_field :password_confirmation, autocomplete: "new-password", class: "form-control" %>
        </div>

        <div class="form-group">
          <%= f.label :first_name %>
          <%= f.text_field :first_name, autocomplete: "first-name", class: "form-control" %>
        </div>

        <div class="form-group">
          <%= f.label :last_name %>
          <%= f.text_field :last_name, autocomplete: "last-name", class: "form-control" %>
        </div>
        
        <div class="form-group">
          <%= f.label :dt_nasc %>
          <%= f.date_select :dt_nasc, class: "form-control" %>
        </div>

        <div class="form-group">
          <%= f.label :user_type %>
          <%= f.select :user_type, ["Medico", "Hospital", "Medico_adm"], { prompt: "Select user type" }, class: "form-control" %>
        </div>

        <div class="form-group text-center">
          <%= f.submit "Sign up", class: "btn btn-primary btn-block" %>
        </div>
      <% end %>

      <%= render "devise/shared/links" %>
    </div>
  </div>
</div>
